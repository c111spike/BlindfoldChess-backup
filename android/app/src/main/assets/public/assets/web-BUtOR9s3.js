import{W as c}from"./index-j-eNxcME.js";class h extends c{constructor(){super(...arguments),this.utteranceIdCounter=0,this.currentUtterances=new Map}async speak(e){if(!("speechSynthesis"in window))throw new Error("Speech synthesis not supported in this browser");const n=`web-utterance-${++this.utteranceIdCounter}`,s=new SpeechSynthesisUtterance(e.text);if(e.voiceId){const t=window.speechSynthesis.getVoices().find(a=>a.voiceURI===e.voiceId||a.name===e.voiceId);t&&(s.voice=t)}else if(e.language){const t=window.speechSynthesis.getVoices().find(a=>a.lang===e.language);t&&(s.voice=t),s.lang=e.language}return e.pitch!==void 0&&(s.pitch=Math.max(0,Math.min(2,e.pitch))),e.rate!==void 0&&(s.rate=Math.max(.1,Math.min(10,e.rate))),e.volume!==void 0&&(s.volume=Math.max(0,Math.min(1,e.volume))),s.onstart=()=>{this.notifyListeners("start",{utteranceId:n})},s.onend=()=>{this.currentUtterances.delete(n),this.notifyListeners("end",{utteranceId:n})},s.onboundary=i=>{this.notifyListeners("boundary",{utteranceId:n,charIndex:i.charIndex,charLength:i.charLength})},s.onerror=i=>{this.currentUtterances.delete(n),this.notifyListeners("error",{utteranceId:n,error:i.error||"Unknown error"})},e.queueStrategy==="Flush"&&(window.speechSynthesis.cancel(),this.currentUtterances.clear()),this.currentUtterances.set(n,s),window.speechSynthesis.speak(s),{utteranceId:n}}async synthesizeToFile(e){throw new Error("synthesizeToFile is not supported on web platform")}async cancel(){"speechSynthesis"in window&&(window.speechSynthesis.cancel(),this.currentUtterances.clear())}async pause(){"speechSynthesis"in window&&window.speechSynthesis.pause()}async resume(){"speechSynthesis"in window&&window.speechSynthesis.resume()}async isSpeaking(){return"speechSynthesis"in window?{isSpeaking:window.speechSynthesis.speaking}:{isSpeaking:!1}}async isAvailable(){return{isAvailable:"speechSynthesis"in window}}async getVoices(){return"speechSynthesis"in window?{voices:window.speechSynthesis.getVoices().map(s=>({id:s.voiceURI,name:s.name,language:s.lang,isNetworkConnectionRequired:!s.localService,default:s.default}))}:{voices:[]}}async getLanguages(){if(!("speechSynthesis"in window))return{languages:[]};const e=window.speechSynthesis.getVoices();return{languages:Array.from(new Set(e.map(s=>s.lang)))}}async isLanguageAvailable(e){return"speechSynthesis"in window?{isAvailable:window.speechSynthesis.getVoices().some(i=>i.lang===e.language)}:{isAvailable:!1}}async isVoiceAvailable(e){return"speechSynthesis"in window?{isAvailable:window.speechSynthesis.getVoices().some(i=>i.voiceURI===e.voiceId||i.name===e.voiceId)}:{isAvailable:!1}}async initialize(){"speechSynthesis"in window&&window.speechSynthesis.getVoices()}async activateAudioSession(e){}async deactivateAudioSession(){}async getPluginVersion(){return{version:"web"}}}export{h as SpeechSynthesisWeb};
